<div class="register-container">
    <div class="register-card">
        <h2 class="register-title">Registro de Usuario</h2>

        <form #registerForm="ngForm" (ngSubmit)="onRegister()" novalidate>

            <!-- Nombre -->
            <div class="form-group">
                <label for="nombre">Nombre</label>
                <input type="text" id="nombre" name="nombre" class="form-input"
                    required minlength="2" [(ngModel)]="user.nombre" #nombreModel="ngModel" placeholder="Nombre"
                    [ngClass]="{'invalid-input': nombreModel.invalid && nombreModel.touched}">
                <div class="error-message" *ngIf="nombreModel.touched && nombreModel.invalid">
                    <span *ngIf="nombreModel.errors?.['required']">Este campo es obligatorio.</span>
                    <span *ngIf="nombreModel.errors?.['minlength']">Debe tener al menos 2 caracteres.</span>
                </div>
            </div>

            <!-- Apellido -->
            <div class="form-group">
                <label for="apellido">Apellido</label>
                <input type="text" id="apellido" name="apellido" class="form-input"
                    required minlength="2" [(ngModel)]="user.apellido" #apellidoModel="ngModel" placeholder="Apellido"
                    [ngClass]="{'invalid-input': apellidoModel.invalid && apellidoModel.touched}">
                <div class="error-message" *ngIf="apellidoModel.touched && apellidoModel.invalid">
                    <span *ngIf="apellidoModel.errors?.['required']">Este campo es obligatorio.</span>
                    <span *ngIf="apellidoModel.errors?.['minlength']">Debe tener al menos 2 caracteres.</span>
                </div>
            </div>

            <!-- Correo -->
            <div class="form-group">
                <label for="correo">Correo electrónico</label>
                <input type="email" id="correo" name="correo" class="form-input"
                    required email [(ngModel)]="user.correo" #correoModel="ngModel" placeholder="Correo"
                    [ngClass]="{'invalid-input': correoModel.invalid && correoModel.touched}">
                <div class="error-message" *ngIf="correoModel.touched && correoModel.invalid">
                    <span *ngIf="correoModel.errors?.['required']">Este campo es obligatorio.</span>
                    <span *ngIf="correoModel.errors?.['email']">Debe ser un correo válido.</span>
                </div>
            </div>

            <!-- Usuario -->
            <div class="form-group">
                <label for="usuario">Nombre de usuario</label>
                <input type="text" id="usuario" name="usuario" class="form-input"
                    required minlength="3" [(ngModel)]="user.usuario" #usuarioModel="ngModel" placeholder="Usuario"
                    [ngClass]="{'invalid-input': usuarioModel.invalid && usuarioModel.touched}">
                <div class="error-message" *ngIf="usuarioModel.touched && usuarioModel.invalid">
                    <span *ngIf="usuarioModel.errors?.['required']">Este campo es obligatorio.</span>
                    <span *ngIf="usuarioModel.errors?.['minlength']">Debe tener al menos 3 caracteres.</span>
                </div>
            </div>

            <!-- Contraseña -->
            <div class="form-group">
                <label for="password">Contraseña</label>
                <input type="password" id="password" name="password" class="form-input"
                    required minlength="8" pattern="^(?=.*[A-Z])(?=.*\d).{8,}$"
                    [(ngModel)]="user.password" #passwordModel="ngModel" placeholder="Contraseña"
                    [ngClass]="{'invalid-input': passwordModel.invalid && passwordModel.touched}">
                <small class="password-criteria">Mínimo 8 caracteres, una mayúscula y un número.</small>
                <div class="error-message" *ngIf="passwordModel.touched && passwordModel.invalid">
                    <span *ngIf="passwordModel.errors?.['required']">Este campo es obligatorio.</span>
                    <span *ngIf="passwordModel.errors?.['pattern']">Formato inválido.</span>
                </div>
            </div>

            <!-- Repetir Contraseña -->
            <div class="form-group">
                <label for="confirmPassword">Repetir contraseña</label>
                <input type="password" id="confirmPassword" name="confirmPassword" class="form-input"
                    required [(ngModel)]="confirmPassword" #confirmPasswordModel="ngModel" placeholder="Repetir contraseña"
                    [ngClass]="{'invalid-input': confirmPasswordModel.invalid && confirmPasswordModel.touched || (user.password !== confirmPassword && confirmPasswordModel.touched)}">
                <div class="error-message" *ngIf="confirmPasswordModel.touched && user.password !== confirmPassword">
                    Las contraseñas no coinciden.
                </div>
            </div>

            <!-- Fecha de nacimiento -->
            <div class="form-group">
                <label for="fechaNacimiento">Fecha de nacimiento</label>
                <input type="date" id="fechaNacimiento" name="fechaNacimiento" class="form-input"
                    required [(ngModel)]="user.fechaNacimiento" #fechaNacimientoModel="ngModel" placeholder="Fecha de nacimiento"
                    [ngClass]="{'invalid-input': fechaNacimientoModel.invalid && fechaNacimientoModel.touched}">
                <div class="error-message" *ngIf="fechaNacimientoModel.touched && fechaNacimientoModel.invalid">
                    Este campo es obligatorio.
                </div>
            </div>

            <!-- Descripción -->
            <div class="form-group">
                <label for="descripcion">Descripción breve</label>
                <textarea id="descripcion" name="descripcion" class="form-input"
                        required minlength="10" rows="3" [(ngModel)]="user.descripcion" #descripcionModel="ngModel" placeholder="Descripción"
                        [ngClass]="{'invalid-input': descripcionModel.invalid && descripcionModel.touched}"></textarea>
                <div class="error-message" *ngIf="descripcionModel.touched && descripcionModel.invalid">
                    <span *ngIf="descripcionModel.errors?.['required']">Este campo es obligatorio.</span>
                    <span *ngIf="descripcionModel.errors?.['minlength']">Debe tener al menos 10 caracteres.</span>
                </div>
            </div>

            <!-- Imagen de perfil -->
            <div class="form-group">
                <label for="imagenPerfil">Imagen de perfil</label>
                <input type="file" id="imagenPerfil" name="imagenPerfil" class="form-input"
                    accept="image/*" (change)="onFileSelected($event)">
            </div>

            <!-- Perfil -->
            <div class="form-group">
                <label for="perfil">Perfil</label>
                <select id="perfil" name="perfil" class="form-input"
                        [(ngModel)]="user.perfil" required>
                <option value="usuario">Usuario</option>
                <option value="administrador">Administrador</option>
                </select>
            </div>

            <!-- Botón -->
            <div class="form-group">
                <button type="submit" class="register-button" [disabled]="registerForm.invalid || loading">
                    {{ loading ? 'Registrando...' : 'Registrarse' }}
                </button>
            </div>

        </form>
    </div>
</div>